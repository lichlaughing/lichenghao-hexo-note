---
title: Elasticsearch 倒排索引
categories: elasticsearch
tags:
  - elasticsearch
keywords: elasticsearch
abbrlink: ed38b947
date: 2022-02-15 12:30:00
---


## 什么是倒排索引？

倒排索引是一种索引的结构，既然有倒排索引那么必然是有正排索引的，关系型数据库中的索引就是正排索引。假设我们有如下的一张表（tb_article）

| ID   | 作者 | 标题     | 文章内容                  | 发布时间   |
| ---- | ---- | -------- | ------------------------- | ---------- |
| 1    | 张三 | 编程快乐 | 学习编程，其乐无穷        | 2020-12-12 |
| 2    | 李四 | 写BUG    | 编程使我快乐，我喜欢写BUG | 2020-12-03 |
| 3    | 王五 | 面向对象 | 用JAVA写BUG               | 2020-11-02 |

可以用ID或者标题作为索引去检索如下所示：通过ID或者标题可以很快的查询到文章的内容

​																		**正排索引**

| 索引     | 内容                      |
| -------- | ------------------------- |
| 1        | 学习编程，其乐无穷        |
| 编程快乐 | 学习编程，其乐无穷        |
| 2        | 编程使我快乐，我喜欢写BUG |
| 写BUG    | 编程使我快乐，我喜欢写BUG |
| 3        | 用JAVA写BUG               |
| 面向对象 | 用JAVA写BUG               |

如果我现在想要查询包含`编程`的文章，我们可以用数据库中like的方式去查询内容。但是如果我们的文章数量巨多，那么这样的查询是灾难性的。

倒排索引解决了这样的问题。正排索引记录的是索引——>文章的映射关系，而倒排索引记录的是`关键词——>文章`的映射关系

那么倒排索引的对应关系可能是如下所示：（Token:可以理解为一个短语被分成的一个一个的词语）

​																							**倒排索引**

| Token | 文档ID1 | 文档2 | 文档3 |
| :---: | :-----: | :---: | :---: |
| 学习  |    √    |       |       |
| 编程  |    √    |   √   |       |
| 无穷  |    √    |       |       |
| 快乐  |         |   √   |       |
| 喜欢  |         |   √   |       |
|  BUG  |         |   √   |   √   |
| JAVA  |         |       |   √   |

这个时候我们再去通过倒排索引搜索，就可以很快的知道包含编程的相关文档是文档1和文档2



